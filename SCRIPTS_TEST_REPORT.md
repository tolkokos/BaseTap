# üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ - –û—Ç—á–µ—Ç

**–î–∞—Ç–∞:** 2025-01-20  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –°–ö–†–ò–ü–¢–´ –†–ê–ë–û–¢–ê–Æ–¢

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

### 1. `scripts/read-proxy-info.ts`
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ê–ë–û–¢–ê–ï–¢

**–¢–µ—Å—Ç:**
```bash
PROXY_ADDRESS=0x37a5f589dC699f2Fc18DFAA10050b2D56a071414 \
npx hardhat run --network baseSepolia scripts/read-proxy-info.ts
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
Proxy: 0x37a5f589dC699f2Fc18DFAA10050b2D56a071414
Implementation: 0x21b599ccF8d0bB2702BE0b54d441E42E5b89b585
ProxyAdmin: 0xD8c157e6A790D4676e4de9E8A8f88c6461F33c4F
```

‚úÖ –£—Å–ø–µ—à–Ω–æ —á–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å Base Sepolia

---

### 2. `scripts/check-storage-layout.ts`
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ê–ë–û–¢–ê–ï–¢

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ BaseTap V1 storage layout –≤–∞–ª–∏–¥–µ–Ω
- ‚úÖ BaseTapV2 storage layout –≤–∞–ª–∏–¥–µ–Ω
- ‚úÖ –û–±–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å TransparentProxy

---

### 3. `scripts/test-scripts.ts`
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ê–ë–û–¢–ê–ï–¢

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ Contract factories –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è (BaseTap, BaseTapV2)
- ‚úÖ Environment variables –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
- ‚úÖ Deployment files —á–∏—Ç–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ê–¥—Ä–µ—Å–∞ –ø—Ä–æ–∫—Å–∏ –≤–∞–ª–∏–¥–Ω—ã:
  - Base Sepolia: `0x37a5f589dC699f2Fc18DFAA10050b2D56a071414`
  - Base Mainnet: `0xCDBbe936bf1930e9B9b841592B45F8B88849A3C0`

---

### 4. `scripts/upgrade.ts`
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```typescript
CONTRACT_VERSION=BaseTapV2 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
PROXY_ADDRESS=<–∏–∑ env –∏–ª–∏ deployments>
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∞–ø–≥—Ä–µ–π–¥–∞ –Ω—É–∂–µ–Ω PRIVATE_KEY —Å owner –ø—Ä–∞–≤–∞–º–∏

---

### 5. `scripts/deploy-transparent.ts`
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ

**–ü–æ–¥–¥–µ—Ä–∂–∫–∞:**
- ‚úÖ BaseTap (V1)
- ‚úÖ BaseTapV2
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è CONTRACT_VERSION –¥–ª—è –≤—ã–±–æ—Ä–∞

---

### 6. `scripts/verify-impl.ts`
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- PROXY_ADDRESS –≤ env
- ETHERSCAN_API_KEY –≤ env
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–µ—Ç—å (--network)

---

## üîß –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: hardhat-toolbox –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ –ó–∞–º–µ–Ω–∏–ª–∏ –Ω–∞ –ø—Ä—è–º–æ–π –∏–º–ø–æ—Ä—Ç:
```typescript
import "@nomicfoundation/hardhat-ethers";
import "@nomicfoundation/hardhat-verify";
import "@openzeppelin/hardhat-upgrades";
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ü—Ä–æ–∫—Å–∏ –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ OZ plugin
**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –û–∂–∏–¥–∞–µ–º–∞—è —Å–∏—Ç—É–∞—Ü–∏—è
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–∏ —Ä–µ–∞–ª—å–Ω–æ–º –∞–ø–≥—Ä–µ–π–¥–µ —á–µ—Ä–µ–∑ GitHub Actions —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º PRIVATE_KEY - –≤—Å—ë –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

---

## üöÄ GitHub Actions Workflows

### `.github/workflows/upgrade-testnet.yml`
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ –ß–∏—Ç–∞–µ—Ç –∞–¥—Ä–µ—Å –ø—Ä–æ–∫—Å–∏ –∏–∑ `deployments/*.json`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç deployment file –ø–æ—Å–ª–µ –∞–ø–≥—Ä–µ–π–¥–∞
- ‚úÖ –ü—ã—Ç–∞–µ—Ç—Å—è verify implementation

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π GitHub ‚Üí Actions
2. –í—ã–±–µ—Ä–∏ "Upgrade BaseTap (Testnet)"
3. –í—ã–±–µ—Ä–∏:
   - Network: `baseSepolia`
   - Version: `BaseTapV2`
4. Run workflow

‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç—Å—è:** PRIVATE_KEY –≤ GitHub Secrets —Å owner –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ –ø—Ä–æ–∫—Å–∏

---

### `.github/workflows/ci.yml`
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ –ö–æ–º–ø–∏–ª—è—Ü–∏—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
- ‚úÖ Linting (prettier + solhint)
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

---

### `.github/workflows/deploy.yml`
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ –î–µ–ø–ª–æ–π –Ω–æ–≤—ã—Ö –ø—Ä–æ–∫—Å–∏
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤ –≤ deployments/
- ‚úÖ –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

---

## üìä –ö–æ–º–ø–∏–ª—è—Ü–∏—è

```bash
npx hardhat compile --force
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ Compiled 9 Solidity files successfully
‚úÖ Generated 42 typings
```

**–ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã:**
- BaseTap.sol (V1)
- BaseTapV2.sol (V2)
- OpenZeppelin dependencies

---

## üéØ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ upgrade

### Base Sepolia (Testnet)
- ‚úÖ –ü—Ä–æ–∫—Å–∏: `0x37a5f589dC699f2Fc18DFAA10050b2D56a071414`
- ‚úÖ –ö–æ–Ω—Ç—Ä–∞–∫—Ç BaseTapV2 —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω
- ‚úÖ Storage layout —Å–æ–≤–º–µ—Å—Ç–∏–º
- ‚úÖ GitHub Action –≥–æ—Ç–æ–≤
- ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è: –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ GitHub Actions UI

### Base Mainnet
- ‚úÖ –ü—Ä–æ–∫—Å–∏: `0xCDBbe936bf1930e9B9b841592B45F8B88849A3C0`
- ‚è≥ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ –î–µ–Ω—å 3 –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

- [x] –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- [x] –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è
- [x] Storage layout —Å–æ–≤–º–µ—Å—Ç–∏–º
- [x] GitHub Actions –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [x] Deployment files –≤–∞–ª–∏–¥–Ω—ã
- [x] –ê–¥—Ä–µ—Å–∞ –ø—Ä–æ–∫—Å–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

---

## üîë –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è upgrade

**–í GitHub Secrets –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:**
1. `PRIVATE_KEY` - –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —Å owner –ø—Ä–∞–≤–∞–º–∏
2. `OWNER_ADDRESS` - –∞–¥—Ä–µ—Å owner
3. `TREASURY_ADDRESS` - –∞–¥—Ä–µ—Å treasury
4. `ETHERSCAN_API_KEY` - –∫–ª—é—á –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–í GitHub Variables (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
1. `BASE_SEPOLIA_RPC_URL` - –∫–∞—Å—Ç–æ–º–Ω—ã–π RPC (–µ—Å—Ç—å fallback)
2. `BASE_RPC_URL` - –∫–∞—Å—Ç–æ–º–Ω—ã–π RPC (–µ—Å—Ç—å fallback)

---

**–í—ã–≤–æ–¥:** üéâ –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç! –ì–æ—Ç–æ–≤—ã –∫ upgrade —á–µ—Ä–µ–∑ GitHub Actions.
